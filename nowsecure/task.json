{
    "$schema": "https://raw.githubusercontent.com/Microsoft/azure-pipelines-task-lib/master/tasks.schema.json",
    "id": "dd43d8ec-5bd3-497c-906e-c7ae1044a030",
    "name": "nowsecure-azure-ci-extension",
    "friendlyName": "NowSecure Azure CI Extension",
    "description": "NowSecure Azure CI Extension",
    "helpMarkDown": "[NowSecure](http://nowsecure.com)",
    "category": "Build",
    "author": "Nowsecure-com",
    "visibility": [
        "Build",
        "Test",
        "Release"
    ],
    "version": {
        "Major": 0,
        "Minor": 1,
        "Patch": 1
    },
    "instanceNameFormat": "nowsecure-azure-ci-extension $(filepath)",
    "groups": [
        {
            "name": "advanced",
            "displayName": "Advanced",
            "isExpanded": false
        }
    ],
    "inputs": [
        {
            "name": "analysis_type",
            "type": "pickList",
            "label": "Analysis Type",
            "defaultValue": "static",
            "options": {
                "full": "full",
                "static": "static"
            },
            "required": false,
            "helpMarkDown": "Defines the type of assessment to run.  The 'full' runs both dynamic and static analysis tooling.  The 'static' option runs only static.",
            "groupName": "advanced"
        },
        {
            "name": "artifact_dir",
            "type": "string",
            "label": "Artifacts Directory",
            "defaultValue": "$(build.artifactStagingDirectory)/nowsecure",
            "required": false,
            "helpMarkDown": "Defines the directory for nowsecure artifacts to be output to. In the case of the default assessment results would be `./artifacts/nowsecure/assessment.json`"
        },
        {
            "name": "binary_file",
            "type": "filePath",
            "label": "Binary File Path",
            "required": true,
            "helpMarkDown": "Defines the filepath for the ipa / apk that is to be uploaded to run an assessments against."
        },
        {
            "name": "group",
            "type": "string",
            "required": true,
            "label": "Group",
            "helpMarkDown": "Defines the group reference that is used to trigger assessments.  Information on how to get the group reference can be found in the NowSecure Support Portal (support.nowsecure.com)."
        },
        {
            "name": "api_host",
            "type": "string",
            "required": false,
            "defaultValue": "https://lab-api.nowsecure.com",
            "label": "API Host",
            "helpMarkDown": "Defines the NowSecure base API to use.  This will not change unless you are leveraging a single tenant.",
            "groupName": "advanced"
        },
        {
            "name": "ui_host",
            "type": "string",
            "required": false,
            "defaultValue": "https://app.nowsecure.com",
            "label": "UI Host",
            "helpMarkDown": "Defines the NowSecure base UI to use.  This will not change unless you are leveraging a single tenant.",
            "groupName": "advanced"
        },
        {
            "name": "log_level",
            "type": "pickList",
            "required": false,
            "defaultValue": "info",
            "label": "Log Level",
            "options": {
                "debug": "debug",
                "info": "info",
                "warn": "warn",
                "error": "error"
            },
            "helpMarkDown": "Defines the log level set for the NowSecure analysis task.",
            "groupName": "advanced"
        },
        {
            "name": "minimum_score",
            "type": "int",
            "required": false,
            "defaultValue": -1,
            "label": "Minimum Score",
            "helpMarkDown": "Defines the score under which an assessment will fail.",
            "groupName": "advanced"
        },
        {
            "name": "nowsecure_ci_version",
            "type": "string",
            "required": false,
            "defaultValue": "",
            "label": "NowSecure CI Version",
            "helpMarkDown": "Defines version of the underlying NowSecure binary to use.",
            "groupName": "advanced"
        },
        {
            "name": "polling_duration_minutes",
            "type": "int",
            "required": false,
            "label": "Polling Duration",
            "helpMarkDown": "Defines the length of time (in minutes) to poll for an  assessment job completion.  The default for 'static' assessments is 30 minutes.  The default for 'full' assessments is 60 minutes.",
            "groupName": "advanced"
        },
        {
            "name": "token",
            "type": "string",
            "required": true,
            "label": "Token",
            "helpMarkDown": "Defines the token used to communicate with the nowsecure API.  This token should be stored as a secret.  Information on how to create a token can be found in the NowSecure Support Portal (http://support.nowsecure.com/)."
        }
    ],
    "execution": {
        "Node20_1": {
            "target": "index.js"
        }
    }
}
